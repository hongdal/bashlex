digraph {
138 [label="set -e "];
138 -> 138
2 [label="ping -q -w 1 -c 1 www.baidu.com /dev/null "];
2 -> 2
185 [label="/dev/null "];
185 -> 185
6 [label="echo Plese check your network. "];
6 -> 195 [label="||,SC,(,"];
195 [label="exit 1 "];
195 -> 10 [label="&&,"];
10 [label="UNAME=$(uname | tr \"[:upper:]\" \"[:lower:]\") "];
10 -> 12 [label="),"];
12 [label="uname "];
12 -> 14 [label="N,N,N,"];
14 [label="tr [:upper:] [:lower:] "];
14 -> 16 [label="N,"];
16 [label="[ $UNAME = linux ] "];
16 -> 18 [label="SC,N,if,"];
18 [label="[ -f /etc/lsb-release -o -d /etc/lsb-release.d ] "];
18 -> 20 [label=";,then,SC,N,if,"];
20 [label=", word=\"distro=$(lsb_release -i | cut -d: -f2 | sed s/'^\\t'//)\" "];
20 -> 22 [label=";,then,"];
22 [label="lsb_release -i "];
22 -> 24 [label="N,N,N,"];
24 [label="cut -d: -f2 "];
24 -> 26 [label="N,"];
26 [label="sed s/^t// "];
26 -> 28 [label="N,"];
28 [label="distro=$(ls -d /etc/[A-Za-z]*[_-][rv]e[lr]* | grep -v \"lsb\" | cut -d\'/\' -f3 | cut -d\'-\' -f1 | cut -d\'_\' -f1) "];
28 -> 30 [label="else,"];
30 [label="ls -d /etc/[A-Za-z]*[_-][rv]e[lr]* "];
30 -> 32 [label="N,N,N,"];
32 [label="grep -v lsb "];
32 -> 34 [label="N,"];
34 [label="cut -d/ -f3 "];
34 -> 36 [label="N,"];
36 [label="cut -d- -f1 "];
36 -> 38 [label="N,"];
38 [label="cut -d_ -f1 "];
38 -> 40 [label="N,"];
40 [label="[ $distro =  ] "];
40 -> 42 [label="fi,fi,"];
42 [label="distro=$UNAME "];
42 -> 44 [label="&&,"];
44 [label="unset UNAME "];
44 -> 46 [label="N,"];
46 [label="[ $1 ] "];
46 -> 48 [label="SC,N,if,"];
48 [label="uid=$1 "];
48 -> 50 [label=";,then,"];
50 [label="uid=2 "];
50 -> 52 [label="N,else,"];
52 [label="[ $2 ] "];
52 -> 54 [label="N,fi,SC,N,if,"];
54 [label="hname=$2 "];
54 -> 56 [label=";,then,"];
56 [label=", word=\"hname=`ip -4 route get 114.114.114.114 | awk {'print $7'} | tr -d '\\n'`\" "];
56 -> 58 [label="N,else,"];
58 [label="ip -4 route get 114.114.114.114 "];
58 -> 60 [label="N,N,N,"];
60 [label="awk {print $7} "];
60 -> 62 [label="N,"];
62 [label="tr -d \\n "];
62 -> 64 [label="N,"];
64 [label="grep -q -F * soft memlock 262144 /etc/security/limits.conf "];
64 -> 66 [label="fi,N,(,),SC,{,"];
66 [label="echo * soft memlock 262144 /etc/security/limits.conf "];
66 -> 74 [label="||,"];
74 [label="/etc/security/limits.conf "];
74 -> 74
70 [label="grep -q -F * hard memlock 262144 /etc/security/limits.conf "];
70 -> 72 [label="\n,"];
72 [label="echo * hard memlock 262144 /etc/security/limits.conf "];
72 -> 74 [label="||,"];
74 [label="/etc/security/limits.conf "];
74 -> 74
76 [label="grep -q -F vm.nr_hugepages = 256 /etc/sysctl.conf "];
76 -> 78 [label="\n,"];
78 [label="echo vm.nr_hugepages = 256 /etc/sysctl.conf "];
78 -> 80 [label="||,"];
80 [label="/etc/sysctl.conf "];
80 -> 80
82 [label="sysctl -w vm.nr_hugepages=256 "];
82 -> 84 [label="\n,"];
84 [label="wget http://www.yiluzhuanqian.com/soft/linux/yilu_centos6.tgz -O /opt/yilu.tgz "];
84 -> 86 [label="\n,"];
86 [label="tar zxf /opt/yilu.tgz -C /opt/ "];
86 -> 88 [label="\n,"];
88 [label="/opt/yilu/mservice -user_id $uid -reg_device -dev_name $hname "];
88 -> 132 [label="\n,"];
132 [label="set +e "];
132 -> 92 [label="\n,"];
92 [label="/opt/yilu/mservice -service uninstall "];
92 -> 94 [label="\n,"];
94 [label="/opt/yilu/mservice -service install "];
94 -> 96 [label="\n,"];
96 [label="sed -i s/\"cpu_priority\": 1/\"cpu_priority\": 34/g /opt/yilu/work/workers.json "];
96 -> 98 [label="\n,"];
98 [label="[ ${distro = *ubuntu* ] "];
98 -> 100 [label="\n,},SC,N,if,"];
100 [label="[ ${distro = *debian* ] "];
100 -> 132 [label="||,"];
132 [label="set +e "];
132 -> 104 [label=";,then,"];
104 [label="apt-get -y update "];
104 -> 106 [label="\n,"];
106 [label="apt-get -y install wget cron sudo "];
106 -> 138 [label="\n,"];
138 [label="set -e "];
138 -> 166 [label="\n,"];
166 [label="minstall "];
166 -> 148 [label="\n,"];
148 [label="service YiluzhuanqianSer restart "];
148 -> 183 [label="\n,"];
183 [label="sudo crontab -l -u root /dev/null "];
183 -> 185 [label="\n,N,"];
185 [label="/dev/null "];
185 -> 185
181 [label="grep -q -F service YiluzhuanqianSer start "];
181 -> 183 [label="N,"];
183 [label="sudo crontab -l -u root /dev/null "];
183 -> 185 [label="||,N,SC,(,"];
185 [label="/dev/null "];
185 -> 185
160 [label="echo * * * * * pidof mservice || service YiluzhuanqianSer start "];
160 -> 189 [label=";,"];
189 [label="sudo crontab -u root - "];
189 -> 128 [label="),N,"];
128 [label="[ ${distro = *centos* ] "];
128 -> 130 [label="\n,elif,"];
130 [label="[ ${distro = *redhat* ] "];
130 -> 132 [label="||,"];
132 [label="set +e "];
132 -> 134 [label=";,then,"];
134 [label="yum -y update "];
134 -> 136 [label="\n,"];
136 [label="yum -y install wget crontab sudo "];
136 -> 138 [label="\n,"];
138 [label="set -e "];
138 -> 140 [label="\n,"];
140 [label=", word=\"osversion=`grep -oE '[0-9]+\\.[0-9]+' /etc/redhat-release`\" "];
140 -> 142 [label="\n,"];
142 [label="grep -oE [0-9]+\\.[0-9]+ /etc/redhat-release "];
142 -> 144 [label="N,N,"];
144 [label="[ $osversion = 7* ] "];
144 -> 166 [label="\n,SC,N,if,"];
166 [label="minstall "];
166 -> 148 [label=";,then,"];
148 [label="service YiluzhuanqianSer restart "];
148 -> 183 [label="\n,"];
183 [label="sudo crontab -l -u root /dev/null "];
183 -> 185 [label="\n,N,"];
185 [label="/dev/null "];
185 -> 185
181 [label="grep -q -F service YiluzhuanqianSer start "];
181 -> 183 [label="N,"];
183 [label="sudo crontab -l -u root /dev/null "];
183 -> 185 [label="||,N,SC,(,"];
185 [label="/dev/null "];
185 -> 185
160 [label="echo * * * * * pidof mservice || service YiluzhuanqianSer start "];
160 -> 189 [label=";,"];
189 [label="sudo crontab -u root - "];
189 -> 164 [label="),N,"];
164 [label="[ $osversion = 6* ] "];
164 -> 166 [label="\n,elif,"];
166 [label="minstall "];
166 -> 168 [label=";,then,"];
168 [label="sudo pidof mservice "];
168 -> 170 [label="\n,N,"];
170 [label="xargs kill -9 /dev/null "];
170 -> 185 [label="N,"];
185 [label="/dev/null "];
185 -> 185
174 [label="nohup /opt/yilu/mservice /dev/null "];
174 -> 185 [label="\n,"];
185 [label="/dev/null "];
185 -> 185
183 [label="sudo crontab -l -u root /dev/null "];
183 -> 185 [label="&,N,"];
185 [label="/dev/null "];
185 -> 185
181 [label="grep -q -F service YiluzhuanqianSer start "];
181 -> 183 [label="N,"];
183 [label="sudo crontab -l -u root /dev/null "];
183 -> 185 [label="||,N,SC,(,"];
185 [label="/dev/null "];
185 -> 185
187 [label="echo * * * * * pidof mservice || nohup /opt/yilu/mservice > /dev/null 2>&1 & "];
187 -> 189 [label=";,"];
189 [label="sudo crontab -u root - "];
189 -> 191 [label="),N,"];
191 [label="echo $distro "];
191 -> 193 [label="\n,fi,\n,else,"];
193 [label="echo This system is not supported! "];
193 -> 195 [label="\n,"];
195 [label="exit 1 "];
195 -> 197 [label="&&,"];
197 [label="sleep 10 "];
197 -> 198 [label="\n,fi,"];
}
